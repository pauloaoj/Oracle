

SELECT TGFFIN.ABATIMENTO AS ABATIMENTO,TGFFIN.ABATIMENTOCAN AS ABATIMENTOCAN,TGFFIN.AD_CGCCPF AS AD_CGCCPF,TGFFIN.AD_IDPARCANTIGO AS AD_IDPARCANTIGO,TGFFIN.AD_OCACERTADA AS AD_OCACERTADA,TGFFIN.AD_ORIGEMIMPORT AS AD_ORIGEMIMPORT,TGFFIN.AD_PAG_CD_SUBCLASSE AS AD_PAG_CD_SUBCLASSE,TGFFIN.AD_REC_AGENCIA_CHEQUE AS AD_REC_AGENCIA_CHEQUE,TGFFIN.AD_REC_BANCO_CHEQUE AS AD_REC_BANCO_CHEQUE,TGFFIN.AD_REC_CD_BANCO AS AD_REC_CD_BANCO,TGFFIN.AD_REC_CD_CARTEIRA AS AD_REC_CD_CARTEIRA,TGFFIN.AD_REC_CD_CLASSE AS AD_REC_CD_CLASSE,TGFFIN.AD_REC_CD_TIPOCOBRANCA AS AD_REC_CD_TIPOCOBRANCA,TGFFIN.AD_REC_DIG_NOSSO_NR AS AD_REC_DIG_NOSSO_NR,TGFFIN.AD_REC_DT_BAIXA_DOCUMENTO AS AD_REC_DT_BAIXA_DOCUMENTO,TGFFIN.AD_REC_DT_EMISSAO AS AD_REC_DT_EMISSAO,TGFFIN.AD_REC_DT_INCLUSAO_DOCUMENTO AS AD_REC_DT_INCLUSAO_DOCUMENTO,TGFFIN.AD_REC_DT_PROG_VENCIMENTO AS AD_REC_DT_PROG_VENCIMENTO,TGFFIN.AD_REC_DT_REATIVACAO AS AD_REC_DT_REATIVACAO,TGFFIN.AD_REC_HISTORICO AS AD_REC_HISTORICO,TGFFIN.AD_REC_NOSSO_NR AS AD_REC_NOSSO_NR,TGFFIN.AD_REC_NOSSO_NR_MASC AS AD_REC_NOSSO_NR_MASC,TGFFIN.AD_REC_NR_CARGA_NOT AS AD_REC_NR_CARGA_NOT,TGFFIN.AD_REC_NR_CHEQUE AS AD_REC_NR_CHEQUE,TGFFIN.AD_REC_NR_CONTA_CHEQUE AS AD_REC_NR_CONTA_CHEQUE,TGFFIN.AD_REC_NR_NOTA_NOT AS AD_REC_NR_NOTA_NOT,TGFFIN.AD_REC_TIPO_GERACAO AS AD_REC_TIPO_GERACAO,TGFFIN.AD_REC_TIPO_QUITACAO AS AD_REC_TIPO_QUITACAO,TGFFIN.AD_REC_TIPO_SITUACAO AS AD_REC_TIPO_SITUACAO,TGFFIN.AD_REC_USUARIO_INCLUSAO AS AD_REC_USUARIO_INCLUSAO,TGFFIN.AD_REC_VL_ABERTO AS AD_REC_VL_ABERTO,TGFFIN.AGENCIA_CMC7 AS AGENCIA_CMC7,TGFFIN.ALIQICMS AS ALIQICMS,TGFFIN.AUTORIZADO AS AUTORIZADO,TGFFIN.BASEICMS AS BASEICMS,TGFFIN.BASEINSS AS BASEINSS,TGFFIN.BASEIRF AS BASEIRF,TGFFIN.BLOQVAR AS BLOQVAR,TGFFIN.CARTA AS CARTA,TGFFIN.CARTAODESC AS CARTAODESC,TGFFIN.CGC_CPF_CMC7 AS CGC_CPF_CMC7,TGFFIN.CHAVECTE AS CHAVECTE,TGFFIN.CHAVECTEREF AS CHAVECTEREF,TGFFIN.CHAVENFEGNRE AS CHAVENFEGNRE,TGFFIN.CHEQUERASTREADO_CMC7 AS CHEQUERASTREADO_CMC7,TGFFIN.CLASSIFCESSAOOBRA AS CLASSIFCESSAOOBRA,TGFFIN.CODBARRA AS CODBARRA,TGFFIN.CODBCO AS CODBCO,TGFFIN.CODBCO_CMC7 AS CODBCO_CMC7,TGFFIN.CODCBE AS CODCBE,TGFFIN.CODCC AS CODCC,TGFFIN.CODCENCUS AS CODCENCUS,TGFFIN.CODCFO AS CODCFO,TGFFIN.CODCIDFIMCTE AS CODCIDFIMCTE,TGFFIN.CODCIDINICTE AS CODCIDINICTE,TGFFIN.CODCONTATO AS CODCONTATO,TGFFIN.CODCTABCOINT AS CODCTABCOINT,TGFFIN.CODEMP AS CODEMP,TGFFIN.CODEMPBAIXA AS CODEMPBAIXA,TGFFIN.CODFUNC AS CODFUNC,TGFFIN.CODIGOBARRA AS CODIGOBARRA,TGFFIN.CODIMOVELRURAL AS CODIMOVELRURAL,TGFFIN.CODIPTU AS CODIPTU,TGFFIN.CODLST AS CODLST,TGFFIN.CODMOEDA AS CODMOEDA,TGFFIN.CODNAT AS CODNAT,TGFFIN.CODOBRA AS CODOBRA,TGFFIN.CODOBSPADRAO AS CODOBSPADRAO,TGFFIN.CODPARC AS CODPARC,TGFFIN.CODPGTO AS CODPGTO,TGFFIN.CODPROJ AS CODPROJ,TGFFIN.CODREGUA AS CODREGUA,TGFFIN.CODTIPOPER AS CODTIPOPER,TGFFIN.CODTIPOPERBAIXA AS CODTIPOPERBAIXA,TGFFIN.CODTIPTIT AS CODTIPTIT,TGFFIN.CODTRIB AS CODTRIB,TGFFIN.CODUSU AS CODUSU,TGFFIN.CODUSUBAIXA AS CODUSUBAIXA,TGFFIN.CODUSUCOBR AS CODUSUCOBR,TGFFIN.CODVEICULO AS CODVEICULO,TGFFIN.CODVEND AS CODVEND,TGFFIN.CONTA_CMC7 AS CONTA_CMC7,TGFFIN.CUSTASPROCESSUAIS AS CUSTASPROCESSUAIS,TGFFIN.DEPOSITOJUDICIAL AS DEPOSITOJUDICIAL,TGFFIN.DESCRTPAGNFCE AS DESCRTPAGNFCE,TGFFIN.DESDOBDUPL AS DESDOBDUPL,TGFFIN.DESDOBRAMENTO AS DESDOBRAMENTO,TGFFIN.DESPADVOGADO AS DESPADVOGADO,TGFFIN.DESPCART AS DESPCART,TGFFIN.DHBAIXA AS DHBAIXA,TGFFIN.DHMOV AS DHMOV,TGFFIN.DHTIPOPER AS DHTIPOPER,TGFFIN.DHTIPOPERBAIXA AS DHTIPOPERBAIXA,TGFFIN.DIGSAFRA AS DIGSAFRA,TGFFIN.DTALTER AS DTALTER,TGFFIN.DTBAIXAPREV AS DTBAIXAPREV,TGFFIN.DTCONTAB AS DTCONTAB,TGFFIN.DTCONTABBAIXA AS DTCONTABBAIXA,TGFFIN.DTENTSAI AS DTENTSAI,TGFFIN.DTENTSAIINFO AS DTENTSAIINFO,TGFFIN.DTINITREFAPURACAO AS DTINITREFAPURACAO,TGFFIN.DTNEG AS DTNEG,TGFFIN.DTPRAZO AS DTPRAZO,TGFFIN.DTVENC AS DTVENC,TGFFIN.DTVENCINIC AS DTVENCINIC,TGFFIN.EMVPIX AS EMVPIX,TGFFIN.EXIGEISSQN AS EXIGEISSQN,TGFFIN.HISTORICO AS HISTORICO,TGFFIN.IDLOTEFDIC AS IDLOTEFDIC,TGFFIN.IDUNICO AS IDUNICO,TGFFIN.INSSRETIDO AS INSSRETIDO,TGFFIN.IRFRETIDO AS IRFRETIDO,TGFFIN.ISSRETIDO AS ISSRETIDO,TGFFIN.JUROSAVP AS JUROSAVP,TGFFIN.LINHADIGITAVEL AS LINHADIGITAVEL,TGFFIN.M2 AS M2,TGFFIN.MODELONFDES AS MODELONFDES,TGFFIN.MONIOCOREM AS MONIOCOREM,TGFFIN.MOTIVOCANCHEQ AS MOTIVOCANCHEQ,TGFFIN.MOTNAORETERISSQN AS MOTNAORETERISSQN,TGFFIN.NATUREZAOPERDES AS NATUREZAOPERDES,TGFFIN.NFCOMPLFIX AS NFCOMPLFIX,TGFFIN.NFENTSEQFIX AS NFENTSEQFIX,TGFFIN.NOMEEMITENTE_CMC7 AS NOMEEMITENTE_CMC7,TGFFIN.NOSSONUM AS NOSSONUM,TGFFIN.NROLOTEGNRE AS NROLOTEGNRE,TGFFIN.NUACERTOAVC AS NUACERTOAVC,TGFFIN.NUANTBANC AS NUANTBANC,TGFFIN.NUAPONTA AS NUAPONTA,TGFFIN.NUBCO AS NUBCO,TGFFIN.NUCCR AS NUCCR,TGFFIN.NUCHAVELIBCANCH AS NUCHAVELIBCANCH,TGFFIN.NUCHAVELIBREIMPCH AS NUCHAVELIBREIMPCH,TGFFIN.NUCHQ AS NUCHQ,TGFFIN.NUCKC AS NUCKC,TGFFIN.NUCOMPENS AS NUCOMPENS,TGFFIN.NUDEV AS NUDEV,TGFFIN.NUFIN AS NUFIN,TGFFIN.NUFTC AS NUFTC,TGFFIN.NUMBOR AS NUMBOR,TGFFIN.NUMCONTRATO AS NUMCONTRATO,TGFFIN.NUMDUPL AS NUMDUPL,TGFFIN.NUMNFSE AS NUMNFSE,TGFFIN.NUMNOTA AS NUMNOTA,TGFFIN.NUMOS AS NUMOS,TGFFIN.NUMPROCADMJUDIC AS NUMPROCADMJUDIC,TGFFIN.NUMREMESSA AS NUMREMESSA,TGFFIN.NUNOTA AS NUNOTA,TGFFIN.NUPED AS NUPED,TGFFIN.NURENEG AS NURENEG,TGFFIN.OBRACONSTCIVIL AS OBRACONSTCIVIL,TGFFIN.ORDEMCARGA AS ORDEMCARGA,TGFFIN.ORIGEM AS ORIGEM,TGFFIN.PARCRENEG AS PARCRENEG,TGFFIN.PDD AS PDD,TGFFIN.PROVISAO AS PROVISAO,TGFFIN.RATEADO AS RATEADO,TGFFIN.RECADIANTAMENTORURAL AS RECADIANTAMENTORURAL,TGFFIN.RECDESP AS RECDESP,TGFFIN.RECEBCARTAO AS RECEBCARTAO,TGFFIN.RECEBIDO AS RECEBIDO,TGFFIN.REFATCON AS REFATCON,TGFFIN.REGESPTRIBUT AS REGESPTRIBUT,TGFFIN.REJEICAOGNRE AS REJEICAOGNRE,TGFFIN.SEQCAIXA AS SEQCAIXA,TGFFIN.SEQUENCIA AS SEQUENCIA,TGFFIN.SERIENFDES AS SERIENFDES,TGFFIN.SERIENOTA AS SERIENOTA,TGFFIN.SITESPECIALRESP AS SITESPECIALRESP,TGFFIN.STATUSGNRE AS STATUSGNRE,TGFFIN.TIMBLOQUEADA AS TIMBLOQUEADA,TGFFIN.TIMCONTALANC AS TIMCONTALANC,TGFFIN.TIMCONTAREP AS TIMCONTAREP,TGFFIN.TIMCONTRATOADM AS TIMCONTRATOADM,TGFFIN.TIMCONTRATOLOC AS TIMCONTRATOLOC,TGFFIN.TIMCONTRATOLTV AS TIMCONTRATOLTV,TGFFIN.TIMDATADEJUR AS TIMDATADEJUR,TGFFIN.TIMDHBAIXA AS TIMDHBAIXA,TGFFIN.TIMDHGERREPASSE AS TIMDHGERREPASSE,TGFFIN.TIMDHGERREPPARCIAL AS TIMDHGERREPPARCIAL,TGFFIN.TIMDTIMPBOL AS TIMDTIMPBOL,TGFFIN.TIMDTIMPBOLLOCAL AS TIMDTIMPBOLLOCAL,TGFFIN.TIMDTREPASSE AS TIMDTREPASSE,TGFFIN.TIMDTREPPARCIAL AS TIMDTREPPARCIAL,TGFFIN.TIMFECHAMENTO AS TIMFECHAMENTO,TGFFIN.TIMFECHAMENTOALU AS TIMFECHAMENTOALU,TGFFIN.TIMFINGARANTORIG AS TIMFINGARANTORIG,TGFFIN.TIMIMOVEL AS TIMIMOVEL,TGFFIN.TIMNEGOCIACAO AS TIMNEGOCIACAO,TGFFIN.TIMNOMEADVOGADO AS TIMNOMEADVOGADO,TGFFIN.TIMNUFINORIG AS TIMNUFINORIG,TGFFIN.TIMNUMREG AS TIMNUMREG,TGFFIN.TIMORIGEM AS TIMORIGEM,TGFFIN.TIMORIGRENEG AS TIMORIGRENEG,TGFFIN.TIMPARCELA AS TIMPARCELA,TGFFIN.TIMRENEGCANCLOTE AS TIMRENEGCANCLOTE,TGFFIN.TIMRENEGIMV AS TIMRENEGIMV,TGFFIN.TIMRENEGLOTE AS TIMRENEGLOTE,TGFFIN.TIMREPINTELIGENTE AS TIMREPINTELIGENTE,TGFFIN.TIMREPPARCIAL AS TIMREPPARCIAL,TGFFIN.TIMRESCISAOLOC AS TIMRESCISAOLOC,TGFFIN.TIMRESCISAOLTV AS TIMRESCISAOLTV,TGFFIN.TIMSAC AS TIMSAC,TGFFIN.TIMTIPOINTERMED AS TIMTIPOINTERMED,TGFFIN.TIMTXADMGERALU AS TIMTXADMGERALU,TGFFIN.TIMVENDAIMV AS TIMVENDAIMV,TGFFIN.TIMVENDALOTE AS TIMVENDALOTE,TGFFIN.TIMVLRAMORTCONTRATO AS TIMVLRAMORTCONTRATO,TGFFIN.TIMVLRCORRMONET AS TIMVLRCORRMONET,TGFFIN.TIMVLRJUROCONTRATO AS TIMVLRJUROCONTRATO,TGFFIN.TIPAPURACAO AS TIPAPURACAO,TGFFIN.TIPJURO AS TIPJURO,TGFFIN.TIPMARCCHEQ AS TIPMARCCHEQ,TGFFIN.TIPMULTA AS TIPMULTA,TGFFIN.TPAGNFCE AS TPAGNFCE,TGFFIN.TROCOPDV AS TROCOPDV,TGFFIN.VALORPRESENTE AS VALORPRESENTE,TGFFIN.VLRALIBERAR AS VLRALIBERAR,TGFFIN.VLRBAIXA AS VLRBAIXA,TGFFIN.VLRCESSAO AS VLRCESSAO,TGFFIN.VLRCHEQUE AS VLRCHEQUE,TGFFIN.VLRDESC AS VLRDESC,TGFFIN.VLRDESCCALC AS VLRDESCCALC,TGFFIN.VLRDESCEMBUT AS VLRDESCEMBUT,TGFFIN.VLRDESDOB AS VLRDESDOB,TGFFIN.VLRFATCARTAO AS VLRFATCARTAO,TGFFIN.VLRGNREDOIS AS VLRGNREDOIS,TGFFIN.VLRINSS AS VLRINSS,TGFFIN.VLRIRF AS VLRIRF,TGFFIN.VLRISS AS VLRISS,TGFFIN.VLRJURO AS VLRJURO,TGFFIN.VLRJUROEMBUT AS VLRJUROEMBUT,TGFFIN.VLRJUROLIB AS VLRJUROLIB,TGFFIN.VLRJURONEGOC AS VLRJURONEGOC,TGFFIN.VLRMOEDA AS VLRMOEDA,TGFFIN.VLRMOEDABAIXA AS VLRMOEDABAIXA,TGFFIN.VLRMULTA AS VLRMULTA,TGFFIN.VLRMULTAEMBUT AS VLRMULTAEMBUT,TGFFIN.VLRMULTALIB AS VLRMULTALIB,TGFFIN.VLRMULTANEGOC AS VLRMULTANEGOC,TGFFIN.VLRPROV AS VLRPROV,TGFFIN.VLRVARCAMBIAL AS VLRVARCAMBIAL,TGFFIN.VLRVENDOR AS VLRVENDOR, (
SELECT P.RAZAOSOCIAL
FROM TGFPAR P
WHERE P.CODPARC = TGFFIN.CODPARC) AS AD_RAZAOSOPARC, (
		CASE 
          WHEN NUANTBANC IS NOT NULL AND EXISTS(SELECT 1 FROM TGFANB WHERE NUFINTITORI = TGFFIN.NUFIN) THEN 'S'
	      ELSE 'N'
	  END) AS ANTECIPADO, (
CASE 
    WHEN TGFFIN.DTVENC IS NULL THEN 0 
    ELSE
        (CASE 
            WHEN TGFFIN.DHBAIXA IS NOT NULL AND (TGFFIN.VLRBAIXA <> 0 OR TGFFIN.VLRDESC >= TGFFIN.VLRDESDOB) THEN TRUNC((TGFFIN.DHBAIXA) - (TGFFIN.DTVENC))
            ELSE TRUNC((TRUNC(SYSDATE)) - (TRUNC(TGFFIN.DTVENC)))
         END)
END) AS ATRASO, (
CASE 
    WHEN TGFFIN.DTVENCINIC IS NULL THEN 0 
    ELSE
        (CASE 
            WHEN TGFFIN.DHBAIXA IS NOT NULL AND TGFFIN.VLRBAIXA <> 0 THEN TRUNC((TGFFIN.DHBAIXA) - (TGFFIN.DTVENCINIC))
            ELSE TRUNC((TRUNC(SYSDATE)) - (TRUNC(TGFFIN.DTVENCINIC)))
         END)
END) AS ATRASOINICIAL, ( SELECT PAR.CGC_CPF FROM TGFPAR PAR WHERE PAR.CODPARC = TGFFIN.CODPARC) AS CGC_CPF_PARC, ( SELECT TGFPAR.CHAVEPIX FROM TGFPAR WHERE TGFPAR.CODPARC = TGFFIN.CODPARC) AS CHAVEPIX, (
		CASE 
          WHEN 'S' = (SELECT CONCILIADO FROM TGFMBC WHERE TGFMBC.NUBCO = TGFFIN.NUBCO) THEN 'S'
	      ELSE 'N'
	  END) AS CONCILIADO, ( CASE WHEN TGFFIN.DHBAIXA IS NOT NULL AND TGFFIN.NUBCO IS NOT NULL THEN (SELECT ((('Cód.Conta: ' ||  CAST(TSICTA.CODCTABCOINT AS VARCHAR(10))) ||  ' - Descrição: ') ||  TSICTA.DESCRICAO) FROM TSICTA, TGFMBC WHERE TGFMBC.NUBCO = TGFFIN.NUBCO AND TSICTA.CODCTABCOINT = TGFMBC.CODCTABCOINT) ELSE NULL END) AS CTABCOBAIXA, ( CASE WHEN NVL(TGFFIN.NUDEV,0) <> 0 THEN (SELECT MAX(ADC.DESCALINEACHEQDEV) FROM TGFMDC MDC INNER JOIN TGFADC ADC ON(ADC.ALINEACHEQDEV = MDC.ALINEACHEQDEV) WHERE MDC.NUDEV = TGFFIN.NUDEV AND MDC.NUFINORIG = TGFFIN.NUFIN) ELSE NULL END) AS DESCALINEACHEQDEV, (
		SELECT DHCONCILIACAO FROM TGFMBC WHERE NUBCO = TGFFIN.NUBCO) AS DHCONCIL, (
		CASE 
          WHEN NUANTBANC IS NOT NULL THEN (SELECT DTANTBANC FROM TGFANB WHERE NUANTBANC = TGFFIN.NUANTBANC AND NUFINTITORI = TGFFIN.NUFIN)
	      ELSE NULL
	  END) AS DTANTECIPACAO, ( SELECT P.IDTRANSACAO FROM TGFPIX P WHERE P.NUFIN = TGFFIN.NUFIN AND P.SEQPIX = (SELECT MAX(P2.SEQPIX) FROM TGFPIX P2 WHERE P2.NUFIN = TGFFIN.NUFIN)) AS IDTRANSACAOPIX, ( CASE WHEN NVL(TGFFIN.NFCOMPLFIX,0) <> 0 THEN (SELECT CAB.NUMNOTA FROM TGFCAB CAB WHERE CAB.NUNOTA = TGFFIN.NFCOMPLFIX) ELSE NULL END) AS NUMCOMPLFIX, ( CASE WHEN TGFFIN.VLRDESDOB IS NOT NULL AND TGFFIN.VLRDESDOB > 0 THEN(ROUND(TGFFIN.VLRDESC/TGFFIN.VLRDESDOB *100,2)) ELSE 0 END) AS PERCDESC, ( CASE WHEN TGFFIN.DTVENC IS NOT NULL AND TGFFIN.DTNEG IS NOT NULL THEN TRUNC((TGFFIN.DTVENC) - (TGFFIN.DTNEG)) ELSE NULL END) AS PRAZO, ( CASE WHEN TGFFIN.DTVENCINIC IS NOT NULL AND TGFFIN.DTNEG IS NOT NULL THEN TRUNC((TGFFIN.DTVENCINIC) - (TGFFIN.DTNEG)) ELSE NULL END) AS PRAZOINICIAL, ( CASE WHEN TGFFIN.NUNOTA IS NOT NULL AND TGFFIN.NUNOTA > 0 THEN(SELECT CAB.RATEADO FROM TGFCAB CAB WHERE CAB.NUNOTA = TGFFIN.NUNOTA) ELSE 'N' END) AS RATEADOCAB, ( CASE WHEN NVL(TGFFIN.NFCOMPLFIX,0) <> 0 THEN (SELECT CAB.SERIENOTA FROM TGFCAB CAB WHERE CAB.NUNOTA = TGFFIN.NFCOMPLFIX) ELSE NULL END) AS SERIENOTACOMPL, ( SELECT TGFTIT.SUBTIPOVENDA FROM TGFTIT WHERE TGFTIT.CODTIPTIT = TGFFIN.CODTIPTIT) AS SUBTIPOVENDA, ( 
  	CASE WHEN TGFFIN.TIMORIGEM IN ('AL','AV','FC') THEN 
		CASE WHEN TGFFIN.DHBAIXA IS NULL THEN 
			CASE WHEN TRUNC(TGFFIN.DTVENC) < TRUNC(SYSDATE) THEN 
				CASE WHEN TGFFIN.TIMDATADEJUR IS NOT NULL THEN 'Jurídico' 
				ELSE 'Atrasado' END 
			ELSE 'Aberto' END	 
		ELSE 'Baixado' END 
	ELSE NULL END) AS TIMESTAGIO, ( 
	CASE WHEN TGFFIN.TIMORIGEM IN ('AL','AV','FC') THEN 
		(SELECT NVL(SUM(NVL(DTLVALOR, 0)), 0)  
		FROM TIMDTL 
		WHERE DTLPARCELA = TGFFIN.NUFIN 
		AND DTLHISTORICO = NVL(( 
			SELECT INTEIRO 
		    FROM TSIPAR 
		    WHERE UPPER(CHAVE) = 'TIMHISTDETLALUG' 
			AND CODUSU = 0 
		),2)) 
	ELSE NULL END) AS TIMVLRALUGUEL, ( ROUND((NVL(TGFFIN.BASEICMS, 0) * NVL(TGFFIN.ALIQICMS, 0))/100, 2)) AS VLRICMS, ( TGFFIN.VLRJURO + TGFFIN.VLRMULTA) AS VLRJUROSMAISMULTA, ( (NVL(TGFFIN.VLRDESDOB,0) + (CASE WHEN TGFFIN.TIPMULTA = '1' THEN NVL(TGFFIN.VLRMULTA,0) ELSE 0 END) + (CASE WHEN TGFFIN.TIPJURO = '1' THEN NVL(TGFFIN.VLRJURO,0) ELSE 0 END) + NVL(TGFFIN.DESPCART,0) + NVL(TGFFIN.VLRVENDOR,0) - NVL(TGFFIN.VLRDESC,0) - (CASE WHEN TGFFIN.IRFRETIDO = 'S' THEN NVL(TGFFIN.VLRIRF,0) ELSE 0 END) - (CASE WHEN TGFFIN.ISSRETIDO = 'S' THEN NVL(TGFFIN.VLRISS,0) ELSE 0 END) - (CASE WHEN TGFFIN.INSSRETIDO = 'S' THEN NVL(TGFFIN.VLRINSS,0) ELSE 0 END) - NVL(TGFFIN.CARTAODESC,0) + NVL((SELECT ROUND(SUM(I.VALOR * I.TIPIMP),2) FROM TGFIMF I WHERE I.NUFIN = TGFFIN.NUFIN),0) + NVL(TGFFIN.VLRMULTANEGOC,0) + NVL(TGFFIN.VLRJURONEGOC,0) - NVL(TGFFIN.VLRMULTALIB,0) - NVL(TGFFIN.VLRJUROLIB,0) + NVL(TGFFIN.VLRVARCAMBIAL,0)) * NVL(TGFFIN.RECDESP,0)) AS VLRLIQUIDO, ( NVL(TGFFIN.VLRDESDOB, 0) + NVL(TGFFIN.VLRJURO,0) + NVL(TGFFIN.VLRMULTA,0) - NVL(TGFFIN.VLRDESC,0)) AS VLRTOTALCALC, ( CASE WHEN	TGFFIN.VLRCHEQUE IS NOT NULL AND TGFFIN.VLRCHEQUE <> 0 AND TGFFIN.VLRBAIXA IS NOT NULL THEN	TGFFIN.VLRCHEQUE - CASE WHEN TGFFIN.NUBCO IS NULL THEN TGFFIN.VLRBAIXA ELSE (SELECT SUM(F.VLRBAIXA) FROM TGFFIN F WHERE F.NUBCO = TGFFIN.NUBCO) END	ELSE 0 END) AS VLRTROCO , CabecalhoNota.NUMNOTA AS l0_NUMNOTA,CabecalhoNota.DTNEG AS l0_DTNEG,CabecalhoNota.PENDENTE AS l0_PENDENTE,CabecalhoNota.STATUSNOTA AS l0_STATUSNOTA,CabecalhoNota.CODPARC AS l0_CODPARC,Parceiro1_1.NOMEPARC AS l1_NOMEPARC,Empresa.NOMEFANTASIA AS l2_NOMEFANTASIA,TipoOperacao.DESCROPER AS l3_DESCROPER,TipoTitulo.DESCRTIPTIT AS l4_DESCRTIPTIT FROM TGFFIN  left join (SELECT PENDENTE,DTNEG,NUMNOTA,NUNOTA,CODPARC,STATUSNOTA FROM TGFCAB) CabecalhoNota  ON(TGFFIN.NUNOTA = CabecalhoNota.NUNOTA) left join (SELECT NOMEPARC,CODPARC FROM TGFPAR) Parceiro1_1  ON(CabecalhoNota.CODPARC = Parceiro1_1.CODPARC) left join (SELECT NOMEFANTASIA,CODEMP FROM TSIEMP) Empresa  ON(TGFFIN.CODEMP = Empresa.CODEMP) left join (SELECT CODTIPOPER,DHALTER,DESCROPER FROM TGFTOP) TipoOperacao  ON(TGFFIN.CODTIPOPER = TipoOperacao.CODTIPOPER AND TGFFIN.DHTIPOPER = TipoOperacao.DHALTER) left join (SELECT CODTIPTIT,DESCRTIPTIT FROM TGFTIT) TipoTitulo  ON(TGFFIN.CODTIPTIT = TipoTitulo.CODTIPTIT)  ,TGFCAB R0_CabecalhoNota  WHERE (((TGFFIN.NUNOTA = R0_CabecalhoNota.NUNOTA)) and ( R0_CabecalhoNota.NUNOTA = 2397714 AND R0_CabecalhoNota.TIPMOV = 'D' AND R0_CabecalhoNota.STATUSNOTA = 'L' AND  TGFFIN.DHBAIXA IS NOT NULL AND NVL(TGFFIN.NUCOMPENS,0) > 0 AND EXISTS(SELECT 1 FROM TGFFRE WHERE NUACERTO=TGFFIN.NUCOMPENS AND TIPACERTO='V'))) 
